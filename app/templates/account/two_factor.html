{% extends "base.html" %}
{% from "_form_helpers.html" import render_field %}

{% block content %}
<div class="container mt-4">
    <h2>Two-Factor Authentication (2FA)</h2>
    <div class="card">
        <div class="card-body">
            {% if current_user.otp_enabled %}
                <p>2FA is currently <strong>enabled</strong> on your account.</p>
                <form method="POST" action="{{ url_for('account.disable_2fa') }}" onsubmit="return confirm('Are you sure you want to disable 2FA?');">
                    {{ disable_2fa_form.hidden_tag() }}
                    {{ disable_2fa_form.submit_disable(class="btn btn-danger") }}
                </form>
            {% else %}
                <p>2FA is currently <strong>disabled</strong>. Scan the QR code with your authenticator app and enter the code to enable it.</p>

                <div class="text-center my-3">
                    {{ qr_code_svg|safe }}
                </div>

                <form method="POST" action="{{ url_for('account.enable_2fa') }}" novalidate>
                    {{ enable_2fa_form.hidden_tag() }}
                    {{ render_field(enable_2fa_form.token) }}
                    {{ enable_2fa_form.submit_enable(class="btn btn-success") }}
                </form>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
